<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gabinete de Crise</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        :root { --verde-br: #009c3b; --amarelo-br: #ffdf00; --azul-br: #002776; --bg-gradient: linear-gradient(135deg, #022a1c 0%, #002776 100%); --card-bg: #ffffff; --text-dark: #1e293b; --danger: #dc2626; --success: #16a34a; }
        body { font-family: 'Inter', sans-serif; background: var(--bg-gradient); color: var(--text-dark); margin: 0; display: flex; flex-direction: column; align-items: center; min-height: 100vh; }
        
        /* Dashboard 4 colunas */
        #dashboard { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; width: 95%; max-width: 900px; padding: 12px; background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); box-shadow: 0 4px 20px rgba(0,0,0,0.2); position: sticky; top: 10px; z-index: 100; border-radius: 16px; border-bottom: 4px solid var(--amarelo-br); }
        .stat { text-align: center; padding: 8px 4px; border-radius: 8px; background: #f8fafc; border: 1px solid #e2e8f0; position: relative; transition: 0.3s; }
        .stat-header { font-size: 0.7rem; color: #64748b; font-weight: 700; text-transform: uppercase; display: flex; flex-direction: column; align-items: center; gap: 2px; }
        .info-btn { background: #e2e8f0; color: var(--azul-br); width: 14px; height: 14px; border-radius: 50%; display: inline-flex; align-items: center; justify-content: center; font-size: 0.6rem; cursor: pointer; margin-left: 4px; }
        .val { font-size: 1rem; font-weight: 800; color: var(--azul-br); display: block; }
        .up-good { background-color: #dcfce7 !important; color: var(--success); transform: scale(1.05); border-color: var(--success); }
        .up-bad { background-color: #fee2e2 !important; color: var(--danger); transform: scale(1.05); border-color: var(--danger); }
        
        /* Jogo */
        #game-container { width: 90%; max-width: 550px; margin-top: 30px; flex-grow: 1; display: flex; flex-direction: column; align-items: center; padding-bottom: 40px; }
        .intro-box { background: var(--card-bg); padding: 40px; border-radius: 24px; text-align: center; box-shadow: 0 20px 40px rgba(0,0,0,0.3); border-top: 6px solid var(--verde-br); }
        .intro-box h2 { color: var(--azul-br); font-size: 2rem; margin: 10px 0; }
        .name-input { width: 80%; padding: 12px; margin: 15px 0; border: 2px solid #cbd5e1; border-radius: 8px; font-size: 1rem; text-align: center; }
        .name-input:focus { border-color: var(--azul-br); outline: none; }
        .consent-wrapper { background: #f1f5f9; padding: 15px; border-radius: 12px; margin-top: 10px; text-align: left; border: 1px solid #cbd5e1; }
        .btn-disabled { background: #94a3b8 !important; cursor: not-allowed !important; opacity: 0.7; }
        
        .card { background: var(--card-bg); padding: 30px; border-radius: 24px; box-shadow: 0 15px 35px rgba(0,0,0,0.25); text-align: center; width: 100%; position: relative; }
        .saiba-mais-btn { background: none; border: none; color: var(--azul-br); font-weight: 600; font-size: 0.8rem; cursor: pointer; margin: 8px 0 15px 0; text-decoration: underline; opacity: 0.8; }
        .explainer { background: #eff6ff; border-left: 4px solid var(--azul-br); padding: 15px; text-align: left; font-size: 0.9rem; border-radius: 8px; margin-bottom: 20px; display: none; color: #334155; }
        #desc { font-size: 1.1rem; color: #475569; margin: 10px 0 30px 0; line-height: 1.6; font-weight: 500; }
        .controls { display: flex; gap: 15px; }
        button.action { flex: 1; padding: 16px; border: none; border-radius: 12px; font-weight: 800; font-size: 1rem; cursor: pointer; color: white; transition: transform 0.1s; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .btn-no { background: var(--danger); } .btn-yes { background: var(--verde-br); }
        
        /* Relat√≥rio */
        #report { display: none; width: 95%; max-width: 1000px; background: #fff; padding: 40px; border-radius: 24px; margin: 20px auto; box-shadow: 0 20px 50px rgba(0,0,0,0.3); }
        .result-card { background: #f8fafc; border-radius: 20px; overflow: hidden; border: 2px solid #e2e8f0; margin-bottom: 30px; }
        .result-header { padding: 20px; text-align: center; color: white; font-size: 1.8rem; font-weight: 800; text-transform: uppercase; }
        .governo-name { display: block; font-size: 0.9rem; font-weight: 400; opacity: 0.9; margin-top: 5px; }
        .result-body { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; padding: 25px; }
        @media (max-width: 600px) { .result-body { grid-template-columns: 1fr; } }
        .result-col h4 { margin-top: 0; color: #64748b; text-transform: uppercase; font-size: 0.8rem; letter-spacing: 1px; }
        .fs-val { font-size: 1.2rem; font-weight: 800; color: #1e293b; margin-top: 5px; }
        .grid-charts { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; }
        .chart-box { background: #fff; padding: 15px; border-radius: 16px; border: 1px solid #e2e8f0; height: 280px; }
        .history-table { width: 100%; border-collapse: collapse; margin-top: 30px; font-size: 0.9rem; }
        .history-table td { padding: 12px; border-bottom: 1px solid #eee; }
        
        #modal { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 25px; border-radius: 16px; box-shadow: 0 20px 60px rgba(0,0,0,0.4); z-index: 2000; width: 300px; text-align: center; }
        #overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 1500; backdrop-filter: blur(3px); }
    </style>
</head>
<body>

<div id="overlay" onclick="closeModal()"></div>
<div id="modal">
    <h3 id="modal-title" style="color: var(--azul-br); margin-top:0;">Info</h3>
    <p id="modal-desc" style="color: #64748b; line-height: 1.5;"></p>
    <button onclick="closeModal()" style="margin-top: 15px; padding: 10px 25px; border: none; background: var(--azul-br); color: white; border-radius: 8px; cursor: pointer;">Entendi</button>
</div>

<div id="dashboard">
    <div id="box-divida" class="stat"><div class="stat-header">üìâ D√≠vida <span class="info-btn" onclick="showModalInfo('divida')">?</span></div><span id="divida" class="val">75%</span></div>
    <div id="box-dolar" class="stat"><div class="stat-header">üíµ D√≥lar <span class="info-btn" onclick="showModalInfo('dolar')">?</span></div><span id="dolar" class="val">5.10</span></div>
    <div id="box-poder" class="stat"><div class="stat-header">üõí Poder <span class="info-btn" onclick="showModalInfo('poder')">?</span></div><span id="poder" class="val">100</span></div>
    <div id="box-pop" class="stat"><div class="stat-header">üìä Pop. <span class="info-btn" onclick="showModalInfo('pop')">?</span></div><span id="pop" class="val">50%</span></div>
</div>

<div id="game-container">
    <div id="intro-screen" class="intro-box">
        <div style="font-size: 3.5rem; margin-bottom: 10px;">üáßüá∑</div>
        <h2>Gabinete de Crise</h2>
        <p>"Bem-vindo ao Gabinete, Ministro. O Brasil √© um pa√≠s de recursos limitados e demandas infinitas. Cada decis√£o sua ser√° um cabo de guerra entre o bem-estar imediato do povo e a confian√ßa dos mercados."</p>
        <input type="text" id="player-name" class="name-input" placeholder="Digite o nome do seu Governo (Ex: Silva)">
        <div class="consent-wrapper">
            <label style="display: flex; gap: 10px; font-size: 0.85rem; cursor: pointer;">
                <input type="checkbox" id="consent-check" onchange="toggleStartButton()">
                <span>Concordo em salvar meus resultados no ranking global.</span>
            </label>
        </div>
        <button id="btn-start" class="action btn-yes btn-disabled" style="width: 100%; margin-top: 20px;" onclick="startGame()" disabled>ASSUMIR O CARGO</button>
    </div>

    <div id="play-area" style="display: none;">
        <div style="color: #64748b; font-weight: 600; margin-bottom: 15px;" id="progress">RODADA 1/20</div>
        <div class="card">
            <h2 id="title">...</h2>
            <button class="saiba-mais-btn" onclick="toggleExplainer()">‚ÑπÔ∏è Entenda o Contexto</button>
            <div id="explainer-box" class="explainer"></div>
            <p id="desc" style="font-size: 1.1rem; color: #475569; margin: 20px 0; line-height: 1.6;">...</p>
            <div class="controls">
                <button class="action btn-no" onclick="handleDecision(false)">RECUSAR ‚ùå</button>
                <button class="action btn-yes" onclick="handleDecision(true)">ACEITAR ‚úÖ</button>
            </div>
        </div>
    </div>
</div>

<div id="report">
    <div class="result-card">
        <div class="result-header" id="result-header">
            <span id="titulo-governo"></span><br>
            <span class="governo-name" id="nome-governo-final"></span>
        </div>
        <div class="result-body">
            <div class="result-col"><h4>A Realidade</h4><p id="result-realidade" class="result-text">...</p></div>
            <div class="result-col"><h4>Veredito Final</h4><p id="result-veredito" class="result-text" style="font-weight:bold;">...</p></div>
        </div>
    </div>

    <div class="final-stats-row" style="display: flex; justify-content: space-around; margin-bottom: 30px; flex-wrap: wrap; gap:10px;">
        <div style="text-align:center;"><div>Pop.</div><div class="fs-val" id="fs-pop">--</div></div>
        <div style="text-align:center;"><div>D√≠vida</div><div class="fs-val" id="fs-divida">--</div></div>
        <div style="text-align:center;"><div>D√≥lar</div><div class="fs-val" id="fs-dolar">--</div></div>
        <div style="text-align:center;"><div>Poder</div><div class="fs-val" id="fs-poder">--</div></div>
    </div>

    <div class="grid-charts">
        <div class="chart-box"><h4>Popularidade</h4><canvas id="chartPop"></canvas></div>
        <div class="chart-box"><h4>D√≠vida</h4><canvas id="chartDiv"></canvas></div>
        <div class="chart-box"><h4>D√≥lar</h4><canvas id="chartDol"></canvas></div>
        <div class="chart-box"><h4>Poder</h4><canvas id="chartPod"></canvas></div>
    </div>

    <h3 style="margin-top: 50px;">Hist√≥rico Detalhado</h3>
    <table class="history-table">
        <thead><tr><th>Dilema</th><th>Decis√£o</th><th>Contexto</th></tr></thead>
        <tbody id="history-body"></tbody>
    </table>
    <button class="action btn-yes" style="width:100%; margin-top:20px;" onclick="location.reload()">NOVO MANDATO</button>
</div>

<script>
    // --- TEXTOS RICOS (Info dos Indicadores) ---
    const infoDocs = {
        divida: { t: "D√≠vida P√∫blica", d: "Rela√ß√£o D√≠vida/PIB. Acima de 90% gera p√¢nico e fuga de capital." },
        dolar: { t: "Cota√ß√£o do D√≥lar", d: "Afeta diretamente o pre√ßo de combust√≠veis, p√£o e eletr√¥nicos." },
        poder: { t: "Poder de Compra", d: "A riqueza real. Cai quando o D√≥lar sobe e a infla√ß√£o aumenta." },
        pop: { t: "Popularidade", d: "Seu capital pol√≠tico. Abaixo de 20%, o risco de queda √© iminente." }
    };

    // --- PAUTAS COMPLETAS (20 Rodadas) ---
    const pautas = [
        { t: "Piso da Enfermagem", d: "O Congresso aprovou o piso salarial nacional de R$ 4.750. A medida corrige uma injusti√ßa hist√≥rica, mas prefeitos e hospitais privados alegam que n√£o t√™m caixa para pagar e amea√ßam demiss√µes.", info: "San√ß√£o valoriza a classe, mas gera custo fiscal imediato e poss√≠vel desemprego no setor.", s: {divida:2, pop:12}, r: {pop:-18} },
        { t: "Taxa√ß√£o de E-commerce", d: "A Receita Federal prop√µe taxar em 60% compras internacionais (Shein/Shopee) abaixo de US$ 50 para proteger o varejo nacional da 'concorr√™ncia desleal'.", info: "A medida agrada empres√°rios brasileiros, mas retira o poder de compra da popula√ß√£o de baixa renda.", s: {divida:-3, pop:-25, poder:-5}, r: {pop:10, divida:1} },
        { t: "Privatiza√ß√£o da Petrobras", d: "Vender o controle acion√°rio da Petrobras para reduzir a d√≠vida p√∫blica em 15% de uma s√≥ vez. O mercado promete chuva de d√≥lares, mas perderemos o controle de pre√ßos.", info: "Venda gera caixa e baixa o d√≥lar agora, mas exp√µe o pa√≠s totalmente √† volatilidade internacional do petr√≥leo.", s: {divida:-15, dolar:-0.8, pop:-20}, r: {divida:2, pop:5} },
        { t: "Programa G√°s para Todos", d: "A oposi√ß√£o pressiona por um subs√≠dio de 100% no botij√£o de g√°s para fam√≠lias do Cadastro √önico. O custo √© de R$ 12 bilh√µes ao ano.", info: "Fundamental para combater a fome, mas √© um gasto permanente que pressiona o teto de gastos.", s: {divida:5, pop:18}, r: {pop:-15} },
        { t: "Fim do Teto de Gastos", d: "Sua base aliada quer derrubar a regra que limita os gastos √† infla√ß√£o, permitindo investir em obras paradas. O mercado financeiro v√™ isso como 'cheque em branco'.", info: "Permite crescimento via obras p√∫blicas, mas gera desconfian√ßa fiscal e alta dos juros.", s: {divida:8, pop:10, dolar:0.4}, r: {divida:-2, dolar:-0.2, pop:-8} },
        { t: "Subs√≠dio ao Agroneg√≥cio", d: "O Plano Safra exige R$ 20 bilh√µes em juros subsidiados para produtores de soja. Sem isso, a safra pode quebrar e a comida encarecer.", info: "Garante a produ√ß√£o e exporta√ß√£o (d√≥lar cai), mas favorece o setor mais rico da economia com dinheiro p√∫blico.", s: {dolar:-0.3, pop:5, divida:4}, r: {dolar:0.2, pop:-5, poder:-2} },
        { t: "Legaliza√ß√£o dos Cassinos", d: "O projeto libera resorts integrados com jogos de azar. A estimativa √© arrecadar R$ 20 bilh√µes em impostos, mas a bancada evang√©lica promete travar o governo.", info: "Dinheiro novo sem aumentar impostos, mas custo pol√≠tico alt√≠ssimo com conservadores.", s: {divida:-5, pop:-10}, r: {divida:1, pop:5} },
        { t: "Reforma Administrativa", d: "Proposta para acabar com a estabilidade de novos servidores p√∫blicos e reduzir sal√°rios de entrada. O mercado adora, mas o funcionalismo amea√ßa greve geral.", info: "Reduz o gasto com folha a longo prazo, mas paralisa servi√ßos p√∫blicos hoje devido √†s greves.", s: {divida:-4, dolar:-0.2, pop:-20}, r: {divida:3, pop:5} },
        { t: "Aumento Real do M√≠nimo", d: "Centrais sindicais exigem aumento de 6% acima da infla√ß√£o para o sal√°rio m√≠nimo. Isso injeta dinheiro na economia, mas explode as contas da Previd√™ncia.", info: "Aumenta o consumo e popularidade, mas metade do gasto federal √© indexado ao m√≠nimo.", s: {divida:7, pop:25}, r: {divida:-2, pop:-20, poder:-5} },
        { t: "Trem Bala Rio-SP", d: "Investidores chineses querem financiar o trem de alta velocidade, mas exigem garantias do Tesouro Nacional de R$ 60 bilh√µes.", info: "Moderniza√ß√£o log√≠stica necess√°ria, mas risco de virar uma d√≠vida impag√°vel se a demanda for baixa.", s: {divida:10, pop:15, dolar:0.2}, r: {divida:-1, pop:-5} },
        { t: "Retaxa√ß√£o dos Combust√≠veis", d: "A isen√ß√£o de impostos na gasolina acabou. Voltar a cobrar impostos melhora o caixa em R$ 30 bi, mas a gasolina vai subir R$ 0,70 na bomba amanh√£.", info: "Responsabilidade fiscal pura, mas impopularidade imediata e infla√ß√£o na veia.", s: {divida:-8, pop:-25, poder:-5}, r: {divida:5, pop:10} },
        { t: "Explora√ß√£o na Foz do Amazonas", d: "A Petrobras quer perfurar po√ßos na Margem Equatorial. Pode render trilh√µes, mas o IBAMA alerta para riscos ambientais irrevers√≠veis.", info: "Potencial de transformar a economia, mas gera crise diplom√°tica ambiental e protestos.", s: {divida:-5, dolar:-0.3, pop:-10}, r: {pop:10, dolar:0.1} },
        { t: "Imposto sobre Grandes Fortunas", d: "Criar uma al√≠quota de 2% para patrim√¥nios acima de R$ 50 milh√µes. A medida agrada a base, mas pode provocar fuga de capital para o exterior.", info: "Justi√ßa fiscal te√≥rica, mas risco pr√°tico de desinvestimento no pa√≠s.", s: {pop:15, dolar:0.5, divida:-2}, r: {pop:-10, dolar:-0.1} },
        { t: "Anistia a Multas Ambientais", d: "A bancada ruralista exige o perd√£o de multas do IBAMA em troca de apoio no Congresso. O valor perdoado seria de R$ 8 bilh√µes.", info: "Garante governabilidade, mas destr√≥i a imagem do Brasil l√° fora (boicote a produtos).", s: {pop:5, dolar:0.4, divida:1}, r: {pop:-5, dolar:-0.1} },
        { t: "Universidade Gratuita para Todos?", d: "Projeto prop√µe cobrar mensalidade em federais de quem ganha acima de 30 sal√°rios m√≠nimos. Gera receita, mas quebra o princ√≠pio da gratuidade universal.", info: "Foca o gasto p√∫blico em quem precisa, mas gera revolta estudantil.", s: {divida:-3, pop:-15}, r: {divida:1, pop:5} },
        { t: "Interven√ß√£o no Banco Central", d: "Os juros est√£o altos demais. Sua base quer mudar a lei para demitir o presidente do BC e for√ßar a queda da taxa SELIC na marra.", info: "Baixa o custo do cr√©dito artificialmente, mas destr√≥i a credibilidade da moeda (D√≥lar dispara).", s: {pop:10, dolar:1.5, poder:-10}, r: {dolar:-0.2, pop:-5} },
        { t: "Isen√ß√£o de IRPF at√© R$ 5 mil", d: "Promessa de campanha: quem ganha at√© 5 mil n√£o paga imposto. O rombo estimado √© de R$ 100 bilh√µes anuais nas contas p√∫blicas.", info: "Aumenta o sal√°rio l√≠quido da classe m√©dia, mas exige corte brutal em sa√∫de e educa√ß√£o para compensar.", s: {pop:30, divida:15, poder:5}, r: {pop:-20, divida:-5} },
        { t: "Compra de Ca√ßas Militares", d: "A For√ßa A√©rea pede R$ 15 bilh√µes para renovar a frota de ca√ßas. √â uma quest√£o de soberania nacional, mas n√£o h√° guerra √† vista.", info: "Fortalece a defesa, mas retira verba de √°reas sociais urgentes.", s: {divida:4, pop:-5}, r: {divida:-1, pop:0} },
        { t: "Regula√ß√£o das Redes Sociais", d: "Criar uma ag√™ncia para multar plataformas que n√£o removerem fake news rapidamente. As Big Techs amea√ßam sair do pa√≠s.", info: "Combate a desinforma√ß√£o, mas gera acusa√ß√µes de censura e perda de investimentos tecnol√≥gicos.", s: {pop:-10, dolar:0.1}, r: {pop:5} },
        { t: "Moeda Comum com Argentina", d: "Criar uma moeda √∫nica para com√©rcio no Mercosul. A ideia √© reduzir depend√™ncia do d√≥lar, mas a economia vizinha est√° quebrada.", info: "Fortalece o bloco pol√≠tico, mas contamina o Real com a infla√ß√£o vizinha.", s: {dolar:0.8, pop:-10, poder:-5}, r: {dolar:-0.1, pop:5} }
    ];

    let currentRound = 0, playerName = "", stats = { divida: 75, dolar: 5.10, poder: 100, pop: 50 };
    let history = { divida: [75], dolar: [5.10], poder: [100], pop: [50] };
    let currentGameLogs = []; 

    function toggleStartButton() {
        const check = document.getElementById('consent-check');
        const btn = document.getElementById('btn-start');
        btn.disabled = !check.checked;
        btn.classList.toggle('btn-disabled', !check.checked);
    }

    function startGame() {
        playerName = document.getElementById('player-name').value.trim() || "Ministro(a)";
        document.getElementById('intro-screen').style.display = 'none';
        document.getElementById('play-area').style.display = 'block';
        updateUI();
    }

    function showModalInfo(key) {
        document.getElementById('modal-title').innerText = infoDocs[key].t;
        document.getElementById('modal-desc').innerText = infoDocs[key].d;
        document.getElementById('modal').style.display = 'block';
        document.getElementById('overlay').style.display = 'block';
    }
    function closeModal() { document.getElementById('modal').style.display = 'none'; document.getElementById('overlay').style.display = 'none'; }
    function toggleExplainer() {
        const box = document.getElementById('explainer-box');
        box.style.display = box.style.display === 'block' ? 'none' : 'block';
    }

    function handleDecision(accepted) {
        const p = pautas[currentRound];
        const effects = accepted ? p.s : (p.r || {});
        currentGameLogs.push({ rodada: currentRound + 1, pauta: p.t, decisao: accepted ? "ACEITOU" : "RECUSOU", contexto: p.info });

        for (let key in effects) if(stats[key] !== undefined) stats[key] += effects[key];
        
        // F√≠sica Econ√¥mica
        if (stats.divida > 85) stats.dolar += 0.10;
        if (stats.divida > 95) stats.dolar += 0.20;
        stats.poder = Math.max(0, 100 - ((stats.dolar - 5.10) * 15));

        for (let key in stats) {
            const box = document.getElementById('box-'+key);
            const diff = stats[key] - history[key][history[key].length-1];
            if (diff !== 0) {
                const bad = (key === 'divida' || key === 'dolar') ? diff > 0 : diff < 0;
                box.classList.add(bad ? 'up-bad' : 'up-good');
                setTimeout(() => box.classList.remove('up-good', 'up-bad'), 600);
            }
            history[key].push(stats[key]);
        }
        
        currentRound++;
        if (currentRound < pautas.length) updateUI();
        else showReport();
    }

    function updateUI() {
        document.getElementById('divida').innerText = stats.divida.toFixed(0) + "%";
        document.getElementById('dolar').innerText = stats.dolar.toFixed(2);
        document.getElementById('poder').innerText = stats.poder.toFixed(0);
        document.getElementById('pop').innerText = stats.pop.toFixed(0) + "%";
        document.getElementById('progress').innerText = `RODADA ${currentRound + 1}/${pautas.length}`;
        document.getElementById('title').innerText = pautas[currentRound].t;
        document.getElementById('desc').innerText = pautas[currentRound].d;
        document.getElementById('explainer-box').innerText = pautas[currentRound].info;
        document.getElementById('explainer-box').style.display = 'none';
    }

    // --- CONEX√ÉO COM NEON VIA NETLIFY FUNCTION ---
    async function enviarParaNeon(titulo, veredito) {
        const dados = {
            nome: playerName,
            perfil: titulo,
            veredito: veredito,
            divida: stats.divida,
            dolar: stats.dolar,
            poder: stats.poder,
            pop: stats.pop
        };

        try {
            await fetch('/.netlify/functions/salvar_partida', {
                method: 'POST',
                body: JSON.stringify(dados)
            });
            console.log("Dados enviados para o banco Neon!");
        } catch (e) {
            console.error("Erro ao salvar:", e);
        }
    }

    function showReport() {
        document.getElementById('play-area').style.display = 'none';
        document.getElementById('dashboard').style.display = 'none';
        document.getElementById('report').style.display = 'block';

        let t="", c="", r="", v="";
        if (stats.dolar > 6.00 || stats.poder < 60) {
            t="üî• O Colapso Total"; c="#b91c1c";
            r="Hiperinfla√ß√£o e destrui√ß√£o da moeda. O povo n√£o consegue comer.";
            v="Voc√™ perdeu o controle da economia. O pa√≠s virou uma Venezuela. Saques a supermercados e caos social.";
        } else if (stats.pop < 20) {
            t="üìâ O Breve (Impeachment)"; c="#7f1d1d";
            r="O Congresso n√£o perdoa fraqueza. Voc√™ perdeu a governabilidade.";
            v="Seu governo caiu antes do fim. Processo de impeachment aprovado.";
        } else if (stats.pop > 60 && stats.divida > 85) {
            t="üí∏ O Populista Irrespons√°vel"; c="#ea580c";
            r="Festa do gasto p√∫blico. Infla√ß√£o futura contratada.";
            v="Voc√™ sai nos bra√ßos do povo, mas deixa uma heran√ßa maldita. O pr√≥ximo presidente ter√° que fazer um ajuste brutal.";
        } else if (stats.divida < 65 && stats.pop < 40) {
            t="üî™ O Tecnocrata Frio"; c="#1d4ed8";
            r="Contas em dia, mas o povo sofre sem servi√ßos e benef√≠cios.";
            v="O mercado te ama, o povo te odeia. Zero chance de reelei√ß√£o.";
        } else if (stats.pop > 60 && stats.divida < 75 && stats.poder > 80) {
            t="üèÜ O Estadista Lend√°rio"; c="#15803d";
            r="Crescimento com responsabilidade. O cen√°rio dos sonhos.";
            v="Voc√™ entra para a hist√≥ria. Conseguiu agradar gregos e troianos. Reelei√ß√£o garantida no 1¬∫ turno.";
        } else {
            t="‚öñÔ∏è O Equilibrista"; c="#475569";
            r="O famoso 'feij√£o com arroz'. N√£o quebrou, mas n√£o decolou.";
            v="Um governo de transi√ß√£o. Voc√™ sobreviveu aos 40 meses sem grandes esc√¢ndalos, mas sem grandes legados.";
        }

        const header = document.getElementById('result-header');
        header.style.backgroundColor = c;
        document.getElementById('titulo-governo').innerText = t;
        document.getElementById('nome-governo-final').innerText = "Governo " + playerName;
        document.getElementById('result-realidade').innerText = r;
        document.getElementById('result-veredito').innerText = v;

        document.getElementById('fs-pop').innerText = stats.pop.toFixed(0) + "%";
        document.getElementById('fs-divida').innerText = stats.divida.toFixed(0) + "%";
        document.getElementById('fs-dolar').innerText = "R$ " + stats.dolar.toFixed(2);
        document.getElementById('fs-poder').innerText = stats.poder.toFixed(0);

        document.getElementById('history-body').innerHTML = currentGameLogs.map(l => 
            `<tr><td><strong>${l.pauta}</strong></td>
            <td><span style="color:${l.decisao==='ACEITOU'?'green':'red'}; font-weight:bold;">${l.decisao}</span></td>
            <td style="color:#64748b; font-size:0.85rem;">${l.contexto}</td></tr>`
        ).join('');

        new Chart(document.getElementById('chartPop'), {type:'line', data:{labels:history.pop.map((_,i)=>i), datasets:[{data:history.pop, borderColor:'#16a34a', fill:true}]}, options:{plugins:{legend:{display:false}}, elements:{point:{radius:0}}}});
        new Chart(document.getElementById('chartDiv'), {type:'line', data:{labels:history.divida.map((_,i)=>i), datasets:[{data:history.divida, borderColor:'#dc2626', fill:true}]}, options:{plugins:{legend:{display:false}}, elements:{point:{radius:0}}}});
        new Chart(document.getElementById('chartDol'), {type:'line', data:{labels:history.dolar.map((_,i)=>i), datasets:[{data:history.dolar, borderColor:'#2563eb', fill:true}]}, options:{plugins:{legend:{display:false}}, elements:{point:{radius:0}}}});
        new Chart(document.getElementById('chartPod'), {type:'line', data:{labels:history.poder.map((_,i)=>i), datasets:[{data:history.poder, borderColor:'#059669', fill:true}]}, options:{plugins:{legend:{display:false}}, elements:{point:{radius:0}}}});

        // Envia para o Neon
        enviarParaNeon(t, v);
    }
</script>
</body>
</html>